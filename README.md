<!-- README.md -->

# ğŸ‡¨ğŸ‡³ TeslaMate-CN-Docker

[![Docker Version](https://img.shields.io/badge/docker-%3E%3D%2020.10-brightgreen)](https://docs.docker.com/)
[![Map Proxy](https://img.shields.io/badge/map-proxy-brightgreen)](https://openstreetmap.org)
[![GitHub stars](https://img.shields.io/github/stars/gococonut/teslamate-cn-docker?style=social)](https://github.com/yourname/teslamate-cn-docker)

> ä¸­å›½å¤§é™†å¯ç”¨çš„ TeslaMate å®¹å™¨åŒ–æ–¹æ¡ˆ Teslamate æ±‰åŒ– Teslamate ä¸­æ–‡| TeslaMate Docker Solution for Mainland China

> [é•œåƒ Repository](https://github.com/gococonut/teslamate)


**å¼ºçƒˆæ¨è** Teslamate iOS appï¼š[Mytess](https://mytess.net)
## ğŸŒŸ ç‰¹æ€§ Features

* âœ… â€‹**å®Œæ•´æ±‰åŒ–** - ç•Œé¢å…¨é¢ä¸­æ–‡åŒ–ï¼ˆæ±‰åŒ–ä¸­ï¼‰
* ğŸ—ºï¸ â€‹**åœ°å›¾è®¿é—®** - å†…ç½®ä»£ç†æœåŠ¡å™¨è§£å†³ OpenStreetMap è®¿é—®é—®é¢˜
* ğŸ—ºï¸ â€‹**ç™¾åº¦åœ°å›¾** - æ”¯æŒç™¾åº¦åœ°å€é€†åœ°å€è§£æï¼Œè½¦è¾†ä½ç½®ä¿¡æ¯æ›´ç²¾å‡†
* ğŸ³ â€‹**ä¸€é”®éƒ¨ç½²** - Docker Compose ä¸€é”®éƒ¨ç½²

## ğŸš€ å¿«é€Ÿå¯åŠ¨ Quick Start


### æœ¬åœ°å†…ç½‘éƒ¨ç½²æ­¥éª¤ Deployment

æœ¬é¡¹ç›®æä¾›ä¸¤ç§éƒ¨ç½²æ–¹å¼ï¼š

| ç‰ˆæœ¬ | æ–‡ä»¶ | è¯´æ˜ |
|------|------|------|
| **æ™®é€šç‰ˆæœ¬** | `docker-compose.yml` | åŸºç¡€ç‰ˆæœ¬ï¼ŒåŒ…å« TeslaMate + Grafana |
| **Mytesla ç‰ˆæœ¬** | `docker-compose-with-mytesla.yml` | é›†æˆ Mytesla Dashï¼Œç°ä»£åŒ–çœ‹æ¿æ›¿ä»£ Grafana |

---

## ğŸ“Š Mytesla Dash - Grafana æ›¿ä»£æ–¹æ¡ˆ

[Mytesla Dash](https://dash.mytesla.cc) æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„ Tesla æ•°æ®çœ‹æ¿ï¼Œå¯ä»¥å®Œç¾æ›¿ä»£ Grafana ä½œä¸ºæ—¥å¸¸ä½¿ç”¨çš„æ•°æ®å±•ç¤ºç•Œé¢ã€‚

### ä¸ºä»€ä¹ˆé€‰æ‹© Mytesla Dashï¼Ÿ

- **ç°ä»£åŒ– UI** - ç®€æ´ç¾è§‚çš„ç•Œé¢è®¾è®¡ï¼Œç§»åŠ¨ç«¯å‹å¥½
- **å¼€ç®±å³ç”¨** - æ— éœ€å¤æ‚çš„ Grafana ä»ªè¡¨ç›˜é…ç½®
- **å®æ—¶ç›‘æ§** - è½¦è¾†çŠ¶æ€ã€å……ç”µè¿›åº¦å®æ—¶å±•ç¤º
- **æ•°æ®åˆ†æ** - è¡Œç¨‹è®°å½•ã€èƒ½è€—ç»Ÿè®¡ã€å……ç”µè´¹ç”¨ä¸€ç›®äº†ç„¶
- **åœ°ç†å›´æ ** - æ”¯æŒè‡ªå®šä¹‰åœ°ç†å›´æ ï¼Œè‡ªåŠ¨è¯†åˆ«å……ç”µåœ°ç‚¹
- **åˆ†æ—¶è®¡è´¹** - å³°è°·ç”µä»·è‡ªåŠ¨è®¡ç®—ï¼Œç²¾ç¡®ç»Ÿè®¡å……ç”µæˆæœ¬

### æˆæƒè¯´æ˜

> **æ³¨æ„**ï¼šMytesla Dash éœ€è¦ä¸€æ¬¡æ€§æˆæƒæ‰èƒ½ä½¿ç”¨ï¼Œé¦–æ¬¡è®¿é—®æ—¶ä¼šå¼•å¯¼å®Œæˆæˆæƒæµç¨‹ã€‚
>
> è·å–æˆæƒç ï¼š[å°çº¢ä¹¦ Mytesla æˆæƒ](https://www.xiaohongshu.com/goods-detail/688dbe5f02d7b00001179ed2)

### ç•Œé¢é¢„è§ˆ

<!-- å›¾ç‰‡1: Dashboard ä¸»ç•Œé¢ -->
![Dashboard ä¸»ç•Œé¢](images/923shots_so.png)

<!-- å›¾ç‰‡2: è®°å½• -->
![è®°å½•](images/650shots_so.png)

<!-- å›¾ç‰‡3: å……ç”µç»Ÿè®¡ -->
![ç»Ÿè®¡](images/148shots_so.png)

---

## ğŸ” åå‘ä»£ç†ä¸è®¤è¯å®‰å…¨

`docker-compose-with-mytesla.yml` é‡‡ç”¨ **Traefik + ForwardAuth** æ¶æ„ï¼Œæä¾›ä¼ä¸šçº§çš„å®‰å…¨é˜²æŠ¤ï¼š

### æ¶æ„è¯´æ˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·è¯·æ±‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Traefik (åå‘ä»£ç†)                           â”‚
â”‚  - ç»Ÿä¸€å…¥å£ (ç«¯å£ 80)                                        â”‚
â”‚  - è·¯ç”±åˆ†å‘                                                  â”‚
â”‚  - ä¸­é—´ä»¶å¤„ç†                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Auth Service (è®¤è¯æœåŠ¡)                         â”‚
â”‚  - Cookie-based ä¼šè¯è®¤è¯                                     â”‚
â”‚  - ç™»å½•/ç™»å‡ºç®¡ç†                                             â”‚
â”‚  - ForwardAuth ä¸­é—´ä»¶                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åç«¯æœåŠ¡                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚TeslaMate â”‚  â”‚  Dash    â”‚  â”‚ Grafana  â”‚  â”‚   API    â”‚    â”‚
â”‚  â”‚/teslamateâ”‚  â”‚    /     â”‚  â”‚ /grafana â”‚  â”‚  /panel  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®‰å…¨ç‰¹æ€§

| ç»„ä»¶ | ä½œç”¨ |
|------|------|
| **Traefik** | åå‘ä»£ç†ï¼Œç»Ÿä¸€ç®¡ç†æ‰€æœ‰æœåŠ¡çš„å…¥å£ï¼Œéšè—å†…éƒ¨æœåŠ¡ç«¯å£ |
| **Auth Service** | æä¾›ç»Ÿä¸€çš„ç™»å½•è®¤è¯ï¼Œä¿æŠ¤æ•æ„Ÿæ•°æ®ä¸è¢«æœªæˆæƒè®¿é—® |
| **ForwardAuth** | æ¯ä¸ªè¯·æ±‚éƒ½ä¼šå…ˆç»è¿‡è®¤è¯æœåŠ¡éªŒè¯ï¼Œç¡®ä¿åªæœ‰ç™»å½•ç”¨æˆ·æ‰èƒ½è®¿é—® |
| **è·¯å¾„éš”ç¦»** | ä¸åŒæœåŠ¡ä½¿ç”¨ä¸åŒè·¯å¾„ï¼Œäº’ä¸å¹²æ‰° |

### è®¿é—®è·¯å¾„

- `/` - Mytesla Dash ä¸»ç•Œé¢ï¼ˆéœ€è¦ç™»å½•ï¼‰
- `/teslamate` - TeslaMate ç®¡ç†ç•Œé¢ï¼ˆéœ€è¦ç™»å½•ï¼‰
- `/grafana` - Grafana ä»ªè¡¨ç›˜
- `/login` - ç™»å½•é¡µé¢
- `/logout` - ç™»å‡º
- `/settings` - è®¾ç½®é¡µé¢

---

## ğŸš€ éƒ¨ç½²æŒ‡å—

### æ–¹å¼ä¸€ï¼šæ™®é€šç‰ˆæœ¬ï¼ˆTeslaMate + Grafanaï¼‰

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/gococonut/teslamate-cn-docker.git
cd teslamate-cn-docker

# å¯åŠ¨æœåŠ¡
docker compose up -d
```

### æ–¹å¼äºŒï¼šMytesla ç‰ˆæœ¬ï¼ˆæ¨èï¼‰

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/gococonut/teslamate-cn-docker.git
cd teslamate-cn-docker

# å¯åŠ¨æœåŠ¡
docker compose -f docker-compose-with-mytesla.yml up -d
```

### è®¿é—®æœåŠ¡

- **æ™®é€šç‰ˆæœ¬**ï¼š
  - TeslaMate: `http://your-ip:4000`
  - Grafana: `http://your-ip:3000`

- **Mytesla ç‰ˆæœ¬**ï¼š
  - ç»Ÿä¸€å…¥å£: `http://your-ip` ï¼ˆé»˜è®¤è·³è½¬åˆ° Dashboardï¼‰
  - TeslaMate: `http://your-ip/teslamate`
  - Grafana: `http://your-ip/grafana`
  - TeslaMate API: `http://your-ip/mytesla/api` ï¼ˆæ— éœ€è®¤è¯ï¼‰
  - é»˜è®¤ç™»å½•: ç”¨æˆ·å `admin` / å¯†ç  `admin123`ï¼ˆå¯åœ¨ `http://your-ip/settings` è®¾ç½®é¡µé¢ä¿®æ”¹ï¼‰

---

## âš ï¸ é‡è¦ï¼šå®‰å…¨é…ç½®

åœ¨ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰ï¼Œ**åŠ¡å¿…ä¿®æ”¹**ä»¥ä¸‹é‡è¦çš„ç¯å¢ƒå˜é‡ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´å®‰å…¨é£é™©ï¼š

### ğŸ” å¿…é¡»ä¿®æ”¹çš„ç¯å¢ƒå˜é‡

ç¼–è¾‘ `docker-compose-with-mytesla.yml` æ–‡ä»¶ï¼Œä¿®æ”¹ä»¥ä¸‹é…ç½®ï¼š

#### 1. Auth æœåŠ¡ç™»å½•å‡­æ®
```yaml
auth:
  environment:
    - AUTH_USERNAME=admin          # âš ï¸ ä¿®æ”¹ä¸ºä½ çš„ç”¨æˆ·å
    - AUTH_PASSWORD=admin123       # âš ï¸ ä¿®æ”¹ä¸ºå¼ºå¯†ç 
    - SECRET_KEY=mytesla-secret-key-change-me  # âš ï¸ ä¿®æ”¹ä¸ºéšæœºå­—ç¬¦ä¸²ï¼ˆè‡³å°‘ 32 ä½ï¼‰
```

#### 2. TeslaMate åŠ å¯†å¯†é’¥
```yaml
teslamate:
  environment:
    - ENCRYPTION_KEY=your-encryption-key-change-me  # âš ï¸ ä¿®æ”¹ä¸ºéšæœºå­—ç¬¦ä¸²ï¼ˆè‡³å°‘ 32 ä½ï¼‰
```

#### 3. æ•°æ®åº“å¯†ç 
```yaml
database:
  environment:
    - POSTGRES_PASSWORD=teslamate  # âš ï¸ ä¿®æ”¹ä¸ºå¼ºå¯†ç 

teslamate:
  environment:
    - DATABASE_PASS=teslamate      # âš ï¸ ä¸æ•°æ®åº“å¯†ç ä¿æŒä¸€è‡´
```

#### 4. Grafana ç®¡ç†å‘˜å¯†ç 
```yaml
grafana:
  environment:
    - GRAFANA_PASSWD=admin123      # âš ï¸ ä¿®æ”¹ä¸ºå¼ºå¯†ç 
    - GF_SECURITY_ADMIN_PASSWORD=admin123  # âš ï¸ ä¿®æ”¹ä¸ºå¼ºå¯†ç 
```

#### 5. TeslaMate API Token
```yaml
teslamateapi:
  environment:
    - API_TOKEN=PLEASE-CHANGE-THIS-API-TOKEN-IN-PRODUCTION  # âš ï¸ ä¿®æ”¹ä¸ºéšæœºå­—ç¬¦ä¸²
    - ENCRYPTION_KEY=your-encryption-key-change-me  # âš ï¸ ä¸ TeslaMate çš„åŠ å¯†å¯†é’¥ä¿æŒä¸€è‡´
```

### ğŸ’¡ å®‰å…¨å»ºè®®

- **ç”Ÿæˆéšæœºå¯†é’¥**ï¼šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆå®‰å…¨çš„éšæœºå­—ç¬¦ä¸²
  ```bash
  # Linux/macOS
  openssl rand -base64 32

  # æˆ–è€…
  cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 32 | head -n 1
  ```

- **å¼ºå¯†ç è¦æ±‚**ï¼š
  - è‡³å°‘ 12 ä½å­—ç¬¦
  - åŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—å’Œç‰¹æ®Šå­—ç¬¦
  - é¿å…ä½¿ç”¨å¸¸è§å¯†ç æˆ–ä¸ªäººä¿¡æ¯

- **å®šæœŸæ›´æ¢å¯†ç **ï¼šå»ºè®®æ¯ 3-6 ä¸ªæœˆæ›´æ¢ä¸€æ¬¡å…³é”®å¯†ç 

- **å¤‡ä»½åŠ å¯†å¯†é’¥**ï¼š`ENCRYPTION_KEY` ç”¨äºåŠ å¯†æ•æ„Ÿæ•°æ®ï¼ˆå¦‚ Tesla API Tokenï¼‰ï¼Œä¸¢å¤±åæ— æ³•æ¢å¤æ•°æ®

### ä¿®æ”¹åé‡å¯æœåŠ¡

```bash
# åœæ­¢æœåŠ¡
docker compose -f docker-compose-with-mytesla.yml down

# é‡æ–°å¯åŠ¨
docker compose -f docker-compose-with-mytesla.yml up -d
```
